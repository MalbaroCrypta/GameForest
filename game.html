<!doctype html>
<html lang="uk" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GameForest — Game</title>
  <meta name="description" content="GameForest game detail" />
  <meta name="keywords" content="game, price history, analytics" />
  <link rel="icon" type="image/svg+xml" href="./assets/gameforest-logo.svg">
  <link rel="stylesheet" href="./styles.css?v=official" />
</head>
<body data-page="catalog">
  <header class="topbar">
    <div class="topbar__left">
      <button class="iconbtn iconbtn--bare" id="btnMenu" title="Menu">☰</button>
      <a class="brand" href="index.html">
        <div class="brand__logo"><img src="./assets/gameforest-logo.svg" alt="GameForest logo"></div>
        <div class="brand__name">GameForest</div>
      </a>
      <nav class="topnav">
        <a class="topnav__btn" data-page="catalog" href="index.html" data-i18n="navCatalog">Каталог</a>
        <a class="topnav__btn" data-page="market" href="market.html" data-i18n="navMarket">Маркетплейс</a>
        <a class="topnav__btn" data-page="about" href="about.html" data-i18n="navAbout">Про проєкт</a>
        <a class="topnav__btn" data-page="account" href="account.html" data-i18n="navAccount" hidden aria-hidden="true">Мій акаунт</a>
      </nav>
    </div>
    <div class="topbar__center"></div>
    <div class="topbar__right">
      <button class="chip chip--ghost" id="themeToggle" title="Dark / Light">Dark</button>
      <button class="chip chip--ghost" id="langToggle" title="UA / EN">UA</button>
      <div class="userpill" id="userToggle" role="button" tabindex="0" hidden>
        <div class="avatar" aria-hidden="true" id="userAvatar">
          <img id="userAvatarImg" alt="" hidden>
          <svg viewBox="0 0 40 40" role="presentation" focusable="false">
            <circle cx="20" cy="14" r="9" class="avatar__face"></circle>
            <rect x="8" y="24" width="24" height="10" rx="5" class="avatar__body"></rect>
          </svg>
        </div>
        <div class="userpill__meta">
          <div class="userpill__email" id="userMenuEmail">guest@gameforest.app</div>
          <div class="userpill__hint" data-i18n="navAccount">Мій акаунт</div>
        </div>
        <span class="chevron">▾</span>
      </div>
      <div class="auth">
        <span class="auth__user" id="userBadge" hidden></span>
        <button class="btn btn--ghost" id="btnLogin" data-i18n="login">Увійти</button>
        <button class="btn btn--primary" id="btnRegister" data-i18n="register">Реєстрація</button>
        <button class="btn btn--ghost" id="btnLogout" hidden data-i18n="logout">Вийти</button>
      </div>
    </div>
  </header>
  <div class="dropdown hidden" id="userDropdown">
    <a class="dropdown__item" href="account.html" data-i18n="navAccount">Мій акаунт</a>
    <button class="dropdown__item" type="button" data-go="wishlist" data-i18n="wishlist">Wishlist</button>
    <button class="dropdown__item" type="button" data-go="cart" data-i18n="cart">Кошик</button>
    <button class="dropdown__item" type="button" data-open="pitch" data-i18n="pitchBtn">Pitch deck</button>
    <button class="dropdown__item" type="button" id="dropdownLogout" data-i18n="logout">Вийти</button>
  </div>
  <div class="drawer" id="navDrawer">
    <div class="drawer__backdrop" data-close="drawer"></div>
    <aside class="drawer__panel">
      <div class="drawer__head">
        <div class="drawer__title" data-i18n="drawerTitle">Швидке меню</div>
        <button class="iconbtn iconbtn--bare" data-close="drawer">✕</button>
      </div>
      <div class="drawer__links">
        <a href="index.html" data-page="catalog" data-i18n="navCatalog">Каталог</a>
        <a href="market.html" data-page="market" data-i18n="navMarket">Маркетплейс</a>
        <a href="about.html" data-page="about" data-i18n="navAbout">Про проєкт</a>
        <a href="account.html" data-page="account" data-i18n="navAccount" hidden aria-hidden="true">Мій акаунт</a>
      </div>
      <div class="drawer__actions">
        <button class="btn btn--ghost w100" data-drawer="wishlist" data-i18n="wishlist">Wishlist</button>
        <button class="btn btn--ghost w100" data-drawer="compare" data-i18n="compareBtn">Compare</button>
        <button class="btn btn--ghost w100" data-open="pitch" data-i18n="pitchBtn">Pitch deck</button>
      </div>
    </aside>
  </div>

  <main class="layout">
    <button class="backlink" id="backBtn" aria-label="Back" data-i18n="detailBack">← Назад</button>
    <section class="hero hero--xl">
      <div class="hero__title" id="gameTitle">Game</div>
      <div class="hero__sub" id="gameSubtitle"></div>
      <div class="hero__meta" id="gameTags"></div>
    </section>

    <section class="panel">
      <div class="panel__head">
        <div>
          <div class="panel__title">Деталі гри</div>
          <div class="panel__muted">SteamDB-style карта з офіційними цінами та рейтингами.</div>
        </div>
        <div class="pill pill--muted" id="steamIdPill">Steam #—</div>
      </div>
      <div class="panel__body panel__body--gap">
        <div class="gametop">
          <div class="gametop__cover skeleton" id="gameCover" aria-label="Game cover placeholder"></div>
          <div>
            <h1 class="gametop__title" id="gameName"></h1>
            <div class="gametop__meta" id="gameMeta"></div>
            <div class="gametop__actions">
              <button class="btn btn--ghost btn--mini" id="shareBtn" data-i18n="detailShare">Поділитися</button>
              <button class="btn btn--ghost btn--mini" id="wishBtn" data-i18n="wishlistAdd">Додати у wishlist</button>
              <button class="btn btn--ghost btn--mini" id="cartBtn" data-i18n="cartAdd">Додати у кошик</button>
              <button class="btn btn--primary btn--mini" id="compareBtn" data-i18n="detailAddCompare">Додати у Compare</button>
            </div>
            <div class="statrow statrow--mini" style="margin-top:12px;">
              <div class="statcard">
                <div class="statcard__label" data-i18n="priceNow">Ціна зараз</div>
                <div class="statcard__value" id="priceNowVal">$0</div>
                <div class="statcard__hint" id="discountVal"></div>
              </div>
              <div class="statcard">
                <div class="statcard__label" data-i18n="rating">Рейтинг</div>
                <div class="statcard__value" id="ratingVal">0</div>
                <div class="statcard__hint" id="healthVal"></div>
              </div>
              <div class="statcard">
                <div class="statcard__label" data-i18n="demand">Попит</div>
                <div class="statcard__value" id="demandVal">0</div>
                <div class="statcard__hint" data-i18n="detailWatch">Watchlist / alerts ready</div>
              </div>
              <div class="statcard">
                <div class="statcard__label" data-i18n="stability">Стабільність ціни</div>
                <div class="statcard__value" id="stabilityVal">0</div>
                <div class="statcard__hint" data-i18n="detailVolatility">Volatility window</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="tabbar" id="tabbar">
      <button class="tab is-active" data-tab="overview" data-i18n="detailTabOverview">Overview</button>
      <button class="tab" data-tab="price" data-i18n="detailTabPrice">Price history</button>
      <button class="tab" data-tab="platforms" data-i18n="detailTabPlatforms">Platforms</button>
      <button class="tab" data-tab="notes" data-i18n="detailTabNotes">Notes</button>
    </div>
    <div class="tabpanes">
      <div class="tabpane" data-tab="overview">
        <div class="grid grid--2">
          <div class="card">
            <div class="card__title" data-i18n="detailSummary">Коротко</div>
            <div class="card__desc" id="summaryText"></div>
          </div>
          <div class="card">
            <div class="card__title" data-i18n="detailMetrics">Здоров'я</div>
            <div class="card__metrics">
              <div class="metric"><div class="metric__label" data-i18n="demand">Попит</div><div class="metric__value" id="mDemand"></div></div>
              <div class="metric"><div class="metric__label" data-i18n="stability">Стабільність ціни</div><div class="metric__value" id="mStab"></div></div>
              <div class="metric"><div class="metric__label" data-i18n="health">Ком'юніті</div><div class="metric__value" id="mHealth"></div></div>
              <div class="metric"><div class="metric__label" data-i18n="model">Модель</div><div class="metric__value" id="mModel"></div></div>
            </div>
          </div>
        </div>
      </div>

      <div class="tabpane hidden" data-tab="price">
        <div class="card__head" style="margin-bottom:10px;">
          <div class="card__title" data-i18n="detailPriceHeadline">Price history</div>
          <div class="flagrow">
            <button class="chip" data-range="1y" data-i18n="detailRangeYear">1Y</button>
            <button class="chip chip--ghost" data-range="all" data-i18n="detailAllTime">All time</button>
          </div>
        </div>
        <div class="chartbox is-loading" id="chartBox">
          <div class="chart__badge" id="chartBadge"></div>
          <svg class="chart" id="priceChart"></svg>
          <div class="chart__tooltip hidden" id="chartTooltip"></div>
        </div>
        <div class="statrow statrow--mini" style="margin-top:10px;">
          <div class="statcard">
            <div class="statcard__label" data-i18n="detailMin">Min</div>
            <div class="statcard__value" id="minVal">$0</div>
          </div>
          <div class="statcard">
            <div class="statcard__label" data-i18n="detailMax">Max</div>
            <div class="statcard__value" id="maxVal">$0</div>
          </div>
          <div class="statcard">
            <div class="statcard__label" data-i18n="detailAvg">Avg</div>
            <div class="statcard__value" id="avgVal">$0</div>
          </div>
        </div>
        <p class="muted" style="margin-top:8px;">Prices shown are fetched from public Steam store data and may be cached or delayed. Simulated curves для прев'ю.</p>
      </div>

      <div class="tabpane hidden" data-tab="platforms">
        <div class="tablewrap">
          <table class="table table--mini">
            <thead>
              <tr>
                <th data-i18n="platforms">Платформи</th>
                <th data-i18n="priceNow">Ціна</th>
                <th data-i18n="discount">Знижка</th>
              </tr>
            </thead>
            <tbody id="platRows"></tbody>
          </table>
        </div>
      </div>

      <div class="tabpane hidden" data-tab="notes">
        <div class="notebox" id="noteBox"></div>
        <p class="muted" style="margin-top:10px;">Preview data · SteamStatic covers · Cached pricing snapshots.</p>
      </div>
    </div>
    <p class="muted" style="margin-top:12px;" data-i18n="detailShareHint">Працює статично: сторінка доступна на GitHub Pages.</p>
  </main>

  <footer class="site-footer">
    <div class="site-footer__wrap">
      <div class="footer__brand">
        <div class="brand__logo"><img src="./assets/gameforest-logo.svg" alt=""></div>
        <div>
          <div class="footer__title">© GameForest. Усі права захищені.</div>
          <div class="footer__disclaimer" data-i18n="footerDisclaimer">Стабільний CDN, кешовані дані та продакшн-ready фронтенд без зайвих залежностей.</div>
        </div>
      </div>
      <div class="footer__payments">
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9">VISA</text></svg>Visa</span>
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9">MC</text></svg>MasterCard</span>
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9"></text></svg>Apple Pay</span>
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9">G</text></svg>Google Pay</span>
      </div>
      <div class="footer__links">
        <a href="#" aria-label="Terms">Terms</a>
        <a href="#" aria-label="Privacy">Privacy</a>
        <a href="#" aria-label="Support">Support</a>
      </div>
      <div class="footer__legal">Сторінка деталей гри: офіційне оформлення, прозорі дисклеймери, аватар користувача у хедері.</div>
    </div>
  </footer>

  <div class="modal hidden" id="authModal">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__card">
      <div class="modal__head">
        <div class="modal__title" id="authTitle">Auth</div>
        <button class="iconbtn" data-close="1">✕</button>
      </div>
      <div class="modal__body" id="authBody"></div>
    </div>
  </div>

  <div class="modal hidden" id="pitchModal">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__card modal__card--wide">
      <div class="modal__head">
        <div class="modal__title" id="pitchTitle">Pitch deck</div>
        <button class="iconbtn" data-close="1">✕</button>
      </div>
      <div class="modal__body" id="pitchBody"></div>
    </div>
  </div>

  <script src="./i18n.js"></script>
  <script src="./supabase-config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.44.4/dist/umd/supabase.min.js"></script>
  <script src="./auth.js"></script>
  <script src="./shell.js"></script>
  <script src="./data.js"></script>
  <script src="./game.js"></script>
</body>
</html>
