// Global i18n helper for GameForest demo
// Stores selected language in localStorage and maps translation keys.
(function(){
  const STORAGE_KEY = "gf_lang";
  const fallback = "uk";
  const saved = (localStorage.getItem(STORAGE_KEY) || fallback).toLowerCase();
  const supported = ["uk", "en"];

  const dict = {
    uk: {
      metaTitle: "GameForest — Каталог ігор та маркетплейс",
      metaDescription: "Демо-панель GameForest: аналітика ігор, маркетплейс донат-валюти та демо-лоти для інвесторського показу.",
      navCatalog: "Каталог",
      navMarket: "Маркетплейс",
      navAbout: "Про проєкт",
      navAccount: "Мій акаунт",
      navSignin: "Увійти",
      drawerTitle: "Швидке меню",
      any: "Усі",
      heroCatalogTitle: "Каталог ігор та аналітика",
      heroCatalogSub: "SteamDB-ish панель: фільтри, сортування, compare, демо-auth.",
      uxDashboard: "збереження в локальному кабінеті",
      accountEyebrow: "Кабінет користувача",
      accountTitle: "Мій акаунт",
      accountViewedHint: "рахується з деталей",
      accountSavedHint: "wishlist",
      accountComparedHint: "до 4 позицій",
      heroMarketTitle: "Маркетплейс / Top-up",
      heroMarketSub: "Офіційні поповнення та демо-лоти без передачі акаунтів.",
      heroAboutTitle: "GameForest — аналітика цін для ігор на всіх платформах",
      heroAboutSub: "Дані про ціни, історію знижок та сигнали «коли купувати». Прозора історія для геймерів, медіа та партнерів.",
      aboutHero: "Про продукт",
      aboutHeroPill1: "PC · PlayStation · Xbox · Switch",
      aboutHeroPill2: "Історія цін + попит + сентимент",
      aboutHeroPill3: "Готовий інвест-пітч",
      kpiGames: "актуальні ігри",
      kpiCompare: "таблиця + compare",
      kpiLanguages: "live перемикач",
      searchPlaceholder: "Пошук гри...",
      filtersTitle: "Фільтри",
      filterPlatform: "Платформа",
      filterGenre: "Жанр",
      filterModel: "Модель монетизації",
      filterMaxPrice: "Макс ціна ($)",
      filterTop: "Тільки Top picks",
      filterApply: "Застосувати",
      filterReset: "Скинути",
      filtersBadgeNone: "Фільтри: вимкнені",
      filtersBadgeSome: "Фільтри: {count}",
      sortBadge: "Сортування",
      tableTitle: "Таблиця",
      tableHint: "Клік по назві відкриває деталі. Кнопки — wishlist та Compare (до 4).",
      actions: "Дії",
      thName: "Назва",
      thOff: "% Знижка",
      thPrice: "Ціна",
      thRating: "Рейтинг",
      thPlatforms: "Платформи",
      pagerEntry: "Записів на сторінці",
      compareBtn: "Compare",
      compareToggle: "У Compare",
      viewDetails: "Деталі гри",
      wishlist: "Wishlist",
      wishlistAdd: "Додати у wishlist",
      wishlistAdded: "Додано у wishlist",
      wishlistSaved: "У wishlist",
      wishlistRemoved: "Видалено з wishlist",
      wishlistEmpty: "Wishlist порожній.",
      wishlistHint: "Збережені ігри з каталогу.",
      cart: "Кошик",
      cartAdd: "Додати у кошик",
      cartAdded: "У кошику",
      cartRemoved: "Видалено з кошика",
      cartEmpty: "Кошик порожній.",
      cartHint: "Підготовлено до майбутніх покупок / маркетплейсу.",
      remove: "Видалити",
      detailBack: "Назад до каталогу",
      detailShare: "Поділитися",
      detailAddCompare: "Додати у Compare",
      detailShareHint: "Працює статично: сторінка доступна на GitHub Pages.",
      detailTabOverview: "Огляд",
      detailTabPrice: "Історія цін",
      detailTabPlatforms: "Платформи",
      detailTabNotes: "Нотатки",
      detailSummary: "Коротко",
      detailMetrics: "Здоров'я",
      detailPriceHeadline: "Price history",
      detailMin: "Мін",
      detailMax: "Макс",
      detailAvg: "Середня",
      detailRangeYear: "12 міс.",
      detailVolatility: "Вікно волатильності",
      detailAllTime: "Весь час",
      detailNoteBuy: "Знижка глибока — варто брати зараз.",
      detailNoteStable: "Ціна стабільна — можна купувати, низький ризик росту.",
      detailNoteWait: "Краще зачекати сезонного сейлу (чорна п'ятниця/зима).",
      detailCopied: "Посилання скопійоване.",
      detailWatch: "Watchlist / alerts ready",
      pitchBtn: "Pitch / Demo",
      emptyData: "Нема даних. Переконайтеся, що data.js підключений.",
      compareHint: "Додайте мінімум 2 гри кліком по рядках.",
      comparePicked: "Вибрано",
      compareClear: "Очистити вибір",
      priceNow: "Ціна зараз",
      discount: "% Знижка",
      rating: "Рейтинг",
      demand: "Попит",
      stability: "Стабільність ціни",
      health: "Ком'юніті",
      platforms: "Платформи",
      model: "Модель",
      genre: "Жанр",
      statsViewed: "Переглянуті ігри",
      statsSaved: "Збережені",
      statsCompared: "Додано у Compare",
      login: "Вхід",
      register: "Реєстрація",
      logout: "Вийти",
      email: "Email",
      password: "Пароль",
      password2: "Повтор пароля",
      createAccount: "Створити акаунт",
      haveAccount: "У мене вже є акаунт",
      signIn: "Увійти",
      noAccount: "Створити акаунт",
      badEmail: "Невірний email.",
      passShort: "Пароль має бути мінімум 6 символів.",
      passMismatch: "Паролі не співпадають.",
      emailExists: "Такий email вже зареєстрований.",
      wrongCreds: "Неправильний email або пароль.",
      authDisclaimer: "Демо: паролі зберігаються локально. Для продакшену використовуйте Supabase/Firebase.",
      pitchTitle: "Pitch / Demo",
      pitchProblem: "Дані по іграх розкидані по магазинах і платформах — важко швидко порівняти та показати бізнес-цінність.",
      pitchSolution: "Єдина панель: таблиця, фільтри, best deal, compare, підсумок за 30 секунд.",
      pitchMonetization: "B2B підписка, API, партнерства, афіліат.",
      pitchOwner: "Власник: Malbaro (founder / product vision).",
      pitchInvestors: "Investor mode: MAU/ARPU (демо), backlog Stripe Checkout, Supabase auth, демо-маркетплейс.",
      modalClose: "Закрити",
      topupTab: "Top-up",
      marketplaceTab: "Marketplace (demo)",
      topupService: "Гра/сервіс",
      topupRegion: "Регіон",
      topupAmount: "Сума поповнення",
      topupCustomAmount: "Або введіть суму",
      topupCheckout: "Перейти до оплати",
      topupTest: "Stripe Test / Demo",
      topupNote: "Для продакшену потрібен бекенд (Vercel/Netlify/Firebase) з endpoint для Stripe session.",
      marketFilters: "Пошук / фільтр лотів",
      marketSearchPlaceholder: "Пошук скіна або акаунта",
      marketType: "Тип",
      marketBadge: "ДЕМО",
      marketDisclaimer: "Демонстраційні лоти. Для реальних угод потрібен комплаєнс та дозволені механіки.",
      marketEmpty: "Немає лотів за цим запитом.",
      checkoutDemoTitle: "Демо-оплата",
      checkoutDemoCopy: "Stripe Test або фейковий чек. Сесія створюється на серверлес /api/create-checkout-session.",
      checkoutDone: "Оплата успішна у демо-режимі.",
      checkoutBack: "Повернутися",
      aboutIntroSection: "Hero / Intro",
      aboutIntroHint: "Що саме будуємо і чому зараз.",
      aboutIntroHeroTitle: "Що таке GameForest",
      aboutIntroHeroBody: "GameForest збирає мультиплатформні ціни, сентимент і доступність, щоб показати найкращий момент для покупки.",
      aboutIntroBullets: [
        "Єдина панель для знижок, стрибків цін і пропозицій у ключових магазинах.",
        "Аналітика рівня інвестора: історія цін, волатильність, індекс попиту.",
        "Інструменти для рішень: best-deal, watchlist, чистий API-вивід."
      ],
      aboutProblemTitle: "Проблема ринку",
      aboutProblemPoints: [
        "Ціни та знижки розкидані по магазинах, регіонах і платформах.",
        "Геймери та медіа вгадують момент покупки без даних.",
        "Бізнесам бракує легального API з надійними пропозиціями."
      ],
      aboutSolutionTitle: "Наше рішення",
      aboutSolutionPoints: [
        "Нормалізований каталог з єдиними ID для PC/console/cloud.",
        "Історія цін, оцінка волатильності та сигнал «кращий час купити».",
        "Алерти, watchlist та віджети для партнерів."
      ],
      aboutDiffTitle: "Чому відрізняємося",
      aboutDifferHint: "Не клон SteamDB — мультиплатформний, про рішення.",
      aboutDifferPoints: [
        "Мультиплатформний дизайн: Steam, PlayStation, Xbox, Switch, офіційні ключі.",
        "Аналітика для рішень: ймовірність наступного сейлу, мін/макс, стабільність.",
        "API та B2B-дашборди з першого дня, споживчий UI залишається чистим."
      ],
      aboutMonetization: "Монетизація",
      aboutMonetPoints: [
        "Free: базовий каталог, поточні ціни, обмежена історія.",
        "Pro: повна історія, алерти, best-time-to-buy, compare.",
        "B2B/API: дашборди, вебхуки, SLA-канали даних.",
        "Affiliates: легальні вихідні посилання з ревшерою."
      ],
      aboutRoadmap: "Roadmap",
      aboutRoadmapNote: "Прив'язка до кварталів, прозорий фокус.",
      aboutRoadmapHint: "Квартальні віхи можна коригувати, релізи інкрементальні.",
      aboutRoadmapBadge: "Delivery",
      aboutRoadmapQ1: "Q1 — публічний демо з мультиплатформним каталогом, згенерованою історією цін, сторінками ігор.",
      aboutRoadmapQ2: "Q2 — Живий збір цін, алерти/watchlists, модель «коли купувати», пробний Pro.",
      aboutRoadmapQ3: "Q3 — Партнерський/API beta, affiliate-роутинг, аналітика бандлів/маркетплейса.",
      aboutRoadmapQ4: "Q4 — Ентерпрайз-дашборди, когортний ретеншн, оверлеї доходів.",
      aboutOwner: "Власник проєкту",
      aboutOwnerMeta: "Owner / продукт / go-to-market",
      aboutOwnerCopy: "Malbaro веде продукт, візію та партнерства. Готовий показати метрики, моделі монетизації та план релізів.",
      aboutCta: "Contact / Partner / Investor",
      aboutCtaPitch: "Open Investor deck",
      aboutCtaTitle: "Call to action",
      aboutCtaCopy: "Потрібен партнер, інвестиція чи API-інтеграція? Напишіть — покажемо демо та цифри.",
      aboutFaqTitle: "FAQ",
      aboutFaqHint: "Дані, легальність, оновлення.",
      faqQ1: "Як збираємо дані?",
      faqA1: "Офіційні API + парсинг сторінок із кешем; демо працює статично.",
      faqQ2: "Це легально?",
      faqA2: "Демо не продає товари. Для продакшену — тільки офіційні інтеграції та партнерські угоди.",
      faqQ3: "Точність 100%?",
      faqA3: "Цілі — свіжі ціни та алерти. Дані кешуються, валідуються, є стор-відхилення.",
      faqQ4: "Як часто оновлюємо?",
      faqA4: "У демо — статично. У продакшену — щогодини для цін, миттєво для алертів.",
      faqQ5: "Звідки ціни?",
      faqA5: "Steam, PlayStation Store, Xbox, Switch, офіційні магазини ключів. Без «сірих» рітейлерів.",
      faqQ6: "Що з API?",
      faqA6: "REST + вебхуки для алертів. Доступ до price history, best-deal, watchlists (B2B).",
      contactName: "Імʼя / Name",
      contactType: "Тип запиту",
      contactTypePartner: "Партнерство",
      contactTypeInvestor: "Інвестор",
      contactTypeApi: "API інтеграція",
      contactMsg: "Повідомлення",
      contactSend: "Надіслати (локально)",
      contactSaved: "Чернетку збережено у браузері.",
      footerDisclaimer: "Стабільні обкладинки SteamStatic. Демо-версія без сторонніх залежностей.",
      seoKeywords: "ігри, аналітика, marketplace, топап, demo",
      successTitle: "Оплата успішна (demo)",
      successBody: "Stripe Test Mode або фейкова сесія. У продакшені замініть endpoint.",
      cancelTitle: "Оплату скасовано",
      cancelBody: "Спробуйте ще раз або змініть спосіб оплати.",
      badgeTop: "Топ",
      quickCompare: "Швидке порівняння",
      entryLabel: "К-сть на сторінку",
      mobileHint: "Таблиця скролиться по горизонталі",
      investorMetrics: "Демо-метрики",
      investorMau: "MAU (demo)",
      investorArpu: "ARPU (demo)",
      investorConv: "Конверсія в checkout (demo)"
    },
    en: {
      metaTitle: "GameForest — Game catalog & marketplace",
      metaDescription: "GameForest demo board: analytics, top-up marketplace, demo listings for investor preview.",
      navCatalog: "Catalog",
      navMarket: "Marketplace",
      navAbout: "About",
      navAccount: "My Account",
      navSignin: "Sign in",
      drawerTitle: "Quick menu",
      any: "All",
      heroCatalogTitle: "Game catalog & analytics",
      heroCatalogSub: "SteamDB-ish board: filters, sorting, compare, demo auth.",
      uxDashboard: "local dashboard storage",
      accountEyebrow: "User dashboard",
      accountTitle: "My Account",
      accountViewedHint: "counts from detail pages",
      accountSavedHint: "wishlist",
      accountComparedHint: "up to 4",
      heroMarketTitle: "Marketplace / Top-up",
      heroMarketSub: "Official balances and demo listings without account transfer.",
      heroAboutTitle: "GameForest — multi-platform price intelligence for games",
      heroAboutSub: "Price history, discount signals, and buy-now guidance for players, media, and partners.",
      aboutHero: "Product overview",
      aboutHeroPill1: "PC · PlayStation · Xbox · Switch",
      aboutHeroPill2: "Price history + sentiment + demand",
      aboutHeroPill3: "Investor-ready deck",
      kpiGames: "games tracked",
      kpiCompare: "table + compare",
      kpiLanguages: "live toggle",
      searchPlaceholder: "Search game...",
      filtersTitle: "Filters",
      filterPlatform: "Platform",
      filterGenre: "Genre",
      filterModel: "Model",
      filterMaxPrice: "Max price ($)",
      filterTop: "Only top picks",
      filterApply: "Apply",
      filterReset: "Reset",
      filtersBadgeNone: "Filters: none",
      filtersBadgeSome: "Filters: {count}",
      sortBadge: "Sort",
      tableTitle: "Table",
      tableHint: "Click a name to open details. Buttons for wishlist and Compare (up to 4).",
      actions: "Actions",
      thName: "Name",
      thOff: "% Off",
      thPrice: "Price",
      thRating: "Rating",
      thPlatforms: "Platforms",
      pagerEntry: "Entries",
      compareBtn: "Compare",
      compareToggle: "In Compare",
      viewDetails: "Game details",
      wishlist: "Wishlist",
      wishlistAdd: "Add to wishlist",
      wishlistAdded: "Added to wishlist",
      wishlistSaved: "In wishlist",
      wishlistRemoved: "Removed from wishlist",
      wishlistEmpty: "Wishlist is empty.",
      wishlistHint: "Games saved from the catalog.",
      cart: "Cart",
      cartAdd: "Add to cart",
      cartAdded: "In cart",
      cartRemoved: "Removed from cart",
      cartEmpty: "Cart is empty.",
      cartHint: "Prepared for future purchases / marketplace.",
      remove: "Remove",
      detailBack: "Back to catalog",
      detailShare: "Share",
      detailAddCompare: "Add to Compare",
      detailShareHint: "Static-friendly: works on GitHub Pages.",
      detailTabOverview: "Overview",
      detailTabPrice: "Price history",
      detailTabPlatforms: "Platforms",
      detailTabNotes: "Notes",
      detailSummary: "Summary",
      detailMetrics: "Health",
      detailPriceHeadline: "Price history",
      detailMin: "Min",
      detailMax: "Max",
      detailAvg: "Avg",
      detailRangeYear: "1Y",
      detailVolatility: "Volatility window",
      detailAllTime: "All time",
      detailNoteBuy: "Discount is deep — good moment to buy.",
      detailNoteStable: "Price is stable — low risk to buy now.",
      detailNoteWait: "Better wait for seasonal sale (Black Friday / Winter).",
      detailCopied: "Link copied.",
      detailWatch: "Watchlist / alerts ready",
      pitchBtn: "Pitch / Demo",
      emptyData: "No data. Ensure data.js is loaded.",
      compareHint: "Pick at least 2 games by clicking rows.",
      comparePicked: "Selected",
      compareClear: "Clear selection",
      priceNow: "Price now",
      discount: "% Off",
      rating: "Rating",
      demand: "Demand",
      stability: "Price stability",
      health: "Community",
      platforms: "Platforms",
      model: "Model",
      genre: "Genre",
      statsViewed: "Viewed games",
      statsSaved: "Saved",
      statsCompared: "Added to Compare",
      login: "Login",
      register: "Register",
      logout: "Logout",
      email: "Email",
      password: "Password",
      password2: "Repeat password",
      createAccount: "Create account",
      haveAccount: "I already have an account",
      signIn: "Sign in",
      noAccount: "Create account",
      badEmail: "Invalid email.",
      passShort: "Password must be at least 6 characters.",
      passMismatch: "Passwords do not match.",
      emailExists: "This email is already registered.",
      wrongCreds: "Wrong email or password.",
      authDisclaimer: "Demo only: passwords are stored locally. Use Supabase/Firebase for production.",
      pitchTitle: "Pitch / Demo",
      pitchProblem: "Game data is scattered across stores and platforms — hard to compare and show business value quickly.",
      pitchSolution: "Single dashboard: table, filters, best deal, compare — 30s to insight.",
      pitchMonetization: "B2B subscription, API, partnerships, affiliate.",
      pitchOwner: "Owner: Malbaro (founder / product vision).",
      pitchInvestors: "Investor mode: MAU/ARPU (demo), backlog Stripe Checkout, Supabase auth, demo marketplace.",
      modalClose: "Close",
      topupTab: "Top-up",
      marketplaceTab: "Marketplace (demo)",
      topupService: "Game/service",
      topupRegion: "Region",
      topupAmount: "Top-up amount",
      topupCustomAmount: "Or enter amount",
      topupCheckout: "Checkout",
      topupTest: "Stripe Test / Demo",
      topupNote: "Production requires backend (Vercel/Netlify/Firebase) endpoint for Stripe session.",
      marketFilters: "Search / filter listings",
      marketSearchPlaceholder: "Search skin or account",
      marketType: "Type",
      marketBadge: "DEMO",
      marketDisclaimer: "Demo listings only. Real trades need compliance and approved mechanics.",
      marketEmpty: "No listings for this query.",
      checkoutDemoTitle: "Demo checkout",
      checkoutDemoCopy: "Stripe Test or fake receipt. Session is created on a serverless /api/create-checkout-session.",
      checkoutDone: "Payment completed in demo mode.",
      checkoutBack: "Back",
      aboutIntroSection: "Hero / Intro",
      aboutIntroHint: "What we are building and why now.",
      aboutIntroHeroTitle: "What is GameForest",
      aboutIntroHeroBody: "GameForest centralizes multi-platform pricing, sentiment, and availability to show where and when to buy.",
      aboutIntroBullets: [
        "Single view of discounts, price spikes, and offers across major stores.",
        "Investor-grade analytics: price history, volatility, demand index.",
        "Decision tools: best-deal flags, watchlists, and clean API outputs."
      ],
      aboutProblemTitle: "Market problem",
      aboutProblemPoints: [
        "Prices and discounts are fragmented by store, region, and platform.",
        "Players and media guess the right moment to buy without data.",
        "Businesses lack a compliant API with trustworthy offers."
      ],
      aboutSolutionTitle: "Our solution",
      aboutSolutionPoints: [
        "Normalized catalog with unified IDs for PC/console/cloud.",
        "Price history, volatility scoring, and a “best time to buy” signal.",
        "Alerts, watchlists, and embeddable components for partners."
      ],
      aboutDiffTitle: "Why we’re different",
      aboutDifferHint: "Not a SteamDB clone — decision-first and multi-platform.",
      aboutDifferPoints: [
        "Multi-platform by design: Steam, PlayStation, Xbox, Switch, official key stores.",
        "Decision-focused analytics: probability of next sale, min/max floors, stability.",
        "API and B2B dashboards from day one; consumer UI stays clean."
      ],
      aboutMonetization: "Monetization",
      aboutMonetPoints: [
        "Free: core catalog, live prices, limited history.",
        "Pro: full history, alerts, best-time-to-buy scoring, compare.",
        "B2B/API: partner dashboards, webhooks, SLA data feeds.",
        "Affiliates: compliant outbound links with revenue share."
      ],
      aboutRoadmap: "Roadmap",
      aboutRoadmapNote: "Clear quarterly focus and delivery cadence.",
      aboutRoadmapHint: "Quarterly milestones with incremental delivery.",
      aboutRoadmapBadge: "Delivery",
      aboutRoadmapQ1: "Q1 — Public demo with multi-platform catalog, generated price history, shareable game pages.",
      aboutRoadmapQ2: "Q2 — Live price ingestion, alerts/watchlists, best-time-to-buy model, Pro trials.",
      aboutRoadmapQ3: "Q3 — Partner/API beta, affiliate routing, marketplace and bundle insights.",
      aboutRoadmapQ4: "Q4 — Enterprise dashboards, retention cohorts, revenue overlays.",
      aboutOwner: "Project owner",
      aboutOwnerMeta: "Owner / product / go-to-market",
      aboutOwnerCopy: "Malbaro owns product direction, investor relations, and partner onboarding. Ready to demo metrics, monetization, and release plans.",
      aboutCta: "Contact / Partner / Investor",
      aboutCtaPitch: "Open Investor deck",
      aboutCtaTitle: "Call to action",
      aboutCtaCopy: "Looking to partner, invest, or embed the API? Reach out — we’ll show the demo and numbers.",
      aboutFaqTitle: "FAQ",
      aboutFaqHint: "Data, legality, freshness.",
      faqQ1: "How do you collect data?",
      faqA1: "Official APIs + page scraping with cache; demo works statically.",
      faqQ2: "Is this legal?",
      faqA2: "Demo doesn’t sell goods. Production uses only official integrations and partner agreements.",
      faqQ3: "Accuracy 100%?",
      faqA3: "Goal — fresh prices and alerts. Data is cached/validated; store variance exists.",
      faqQ4: "How often refreshed?",
      faqA4: "Demo — static. Production — hourly for prices, instant for alerts.",
      faqQ5: "Where do prices come from?",
      faqA5: "Steam, PlayStation Store, Xbox, Switch, official key stores. No gray retailers.",
      faqQ6: "What about API?",
      faqA6: "REST + webhooks for alerts. Access to price history, best deal, watchlists (B2B).",
      contactName: "Імʼя / Name",
      contactType: "Request type",
      contactTypePartner: "Partnership",
      contactTypeInvestor: "Investor",
      contactTypeApi: "API integration",
      contactMsg: "Message",
      contactSend: "Send (local)",
      contactSaved: "Draft stored in browser.",
      footerDisclaimer: "Stable SteamStatic covers. Demo build without fragile dependencies.",
      seoKeywords: "games, analytics, marketplace, top-up, demo",
      successTitle: "Payment successful (demo)",
      successBody: "Stripe Test Mode or fake session. Replace endpoint in production.",
      cancelTitle: "Payment canceled",
      cancelBody: "Try again or switch payment option.",
      badgeTop: "Top",
      quickCompare: "Quick compare",
      entryLabel: "Rows per page",
      mobileHint: "Table is horizontally scrollable",
      investorMetrics: "Investor metrics",
      investorMau: "MAU (demo)",
      investorArpu: "ARPU (demo)",
      investorConv: "Checkout conversion (demo)"
    }
  };

  const lang = supported.includes(saved) ? saved : fallback;

  const api = {
    lang,
    t(key){
      return (dict[this.lang] && key in dict[this.lang]) ? dict[this.lang][key] : key;
    },
    setLang(next){
      this.lang = supported.includes(next) ? next : fallback;
      localStorage.setItem(STORAGE_KEY, this.lang);
      document.documentElement.lang = this.lang;
      this.apply(document);
    },
    apply(root){
      if (!root) return;
      root.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        const val = this.t(key);
        if (Array.isArray(val)) {
          el.textContent = val.join(" · ");
        } else {
          el.textContent = val;
        }
      });
      root.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
        const key = el.getAttribute("data-i18n-placeholder");
        const val = this.t(key);
        el.setAttribute("placeholder", Array.isArray(val) ? val.join(" ") : val);
      });
    }
  };

  window.GF_I18N = api;
  document.title = api.t("metaTitle");
  const metaDesc = document.querySelector('meta[name="description"]');
  if (metaDesc) metaDesc.setAttribute("content", api.t("metaDescription"));
  const metaKeywords = document.querySelector('meta[name="keywords"]');
  if (metaKeywords) metaKeywords.setAttribute("content", api.t("seoKeywords"));
  document.documentElement.lang = api.lang;
})();
