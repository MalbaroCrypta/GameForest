// Global i18n helper for GameForest demo
// Stores selected language in localStorage and maps translation keys.
(function(){
  const STORAGE_KEY = "gf_lang";
  const fallback = "uk";
  const saved = (localStorage.getItem(STORAGE_KEY) || fallback).toLowerCase();
  const supported = ["uk", "en"];

  const dict = {
    uk: {
      metaTitle: "GameForest — Каталог ігор та маркетплейс",
      metaDescription: "Демо-панель GameForest: аналітика ігор, маркетплейс донат-валюти та демо-лоти для інвесторського показу.",
      navCatalog: "Каталог",
      navMarket: "Маркетплейс",
      navAbout: "Про проєкт",
      navSignin: "Увійти",
      any: "Усі",
      heroCatalogTitle: "Каталог ігор та аналітика",
      heroCatalogSub: "SteamDB-ish панель: фільтри, сортування, compare, демо-auth.",
      heroMarketTitle: "Маркетплейс / Top-up",
      heroMarketSub: "Офіційні поповнення та демо-лоти без передачі акаунтів.",
      heroAboutTitle: "Про GameForest",
      heroAboutSub: "Що будуємо, для кого, монетизація та плани.",
      aboutHero: "Місія та цінність",
      aboutTagInvestor: "Investor Mode ready",
      aboutTagStatic: "Статичний демо билд",
      aboutTagMulti: "Multi-platform дані",
      aboutInvestorToggle: "Investor mode",
      kpiGames: "актуальні ігри",
      kpiCompare: "таблиця + compare",
      kpiLanguages: "live перемикач",
      searchPlaceholder: "Пошук гри...",
      filtersTitle: "Фільтри",
      filterPlatform: "Платформа",
      filterGenre: "Жанр",
      filterModel: "Модель монетизації",
      filterMaxPrice: "Макс ціна ($)",
      filterTop: "Тільки Top picks",
      filterApply: "Застосувати",
      filterReset: "Скинути",
      tableTitle: "Таблиця",
      tableHint: "Клік по назві відкриває деталі. Кнопка додає у Compare (до 4).",
      thName: "Назва",
      thOff: "% Знижка",
      thPrice: "Ціна",
      thRating: "Рейтинг",
      thPlatforms: "Платформи",
      pagerEntry: "Записів на сторінці",
      compareBtn: "Compare",
      compareToggle: "У Compare",
      viewDetails: "Деталі гри",
      detailBack: "Назад до каталогу",
      detailShare: "Поділитися",
      detailAddCompare: "Додати у Compare",
      detailShareHint: "Працює статично: сторінка доступна на GitHub Pages.",
      detailTabOverview: "Огляд",
      detailTabPrice: "Історія цін",
      detailTabPlatforms: "Платформи",
      detailTabNotes: "Нотатки",
      detailSummary: "Коротко",
      detailMetrics: "Здоров'я",
      detailPriceHeadline: "Price history",
      detailMin: "Мін",
      detailMax: "Макс",
      detailAvg: "Середня",
      detailAllTime: "Весь час",
      detailNoteBuy: "Знижка глибока — варто брати зараз.",
      detailNoteStable: "Ціна стабільна — можна купувати, низький ризик росту.",
      detailNoteWait: "Краще зачекати сезонного сейлу (чорна п'ятниця/зима).",
      detailCopied: "Посилання скопійоване.",
      detailWatch: "Watchlist / alerts ready",
      pitchBtn: "Pitch / Demo",
      emptyData: "Нема даних. Переконайтеся, що data.js підключений.",
      compareHint: "Додайте мінімум 2 гри кліком по рядках.",
      comparePicked: "Вибрано",
      compareClear: "Очистити вибір",
      priceNow: "Ціна зараз",
      discount: "% Знижка",
      rating: "Рейтинг",
      demand: "Попит",
      stability: "Стабільність ціни",
      health: "Ком'юніті",
      platforms: "Платформи",
      model: "Модель",
      genre: "Жанр",
      login: "Вхід",
      register: "Реєстрація",
      logout: "Вийти",
      email: "Email",
      password: "Пароль",
      password2: "Повтор пароля",
      createAccount: "Створити акаунт",
      haveAccount: "У мене вже є акаунт",
      signIn: "Увійти",
      noAccount: "Створити акаунт",
      badEmail: "Невірний email.",
      passShort: "Пароль має бути мінімум 6 символів.",
      passMismatch: "Паролі не співпадають.",
      emailExists: "Такий email вже зареєстрований.",
      wrongCreds: "Неправильний email або пароль.",
      authDisclaimer: "Демо: паролі зберігаються локально. Для продакшену використовуйте Supabase/Firebase.",
      pitchTitle: "Pitch / Demo",
      pitchProblem: "Дані по іграх розкидані по магазинах і платформах — важко швидко порівняти та показати бізнес-цінність.",
      pitchSolution: "Єдина панель: таблиця, фільтри, best deal, compare, підсумок за 30 секунд.",
      pitchMonetization: "B2B підписка, API, партнерства, афіліат.",
      pitchOwner: "Власник: Malbaro (founder / product vision).",
      pitchInvestors: "Investor mode: MAU/ARPU (демо), backlog Stripe Checkout, Supabase auth, демо-маркетплейс.",
      modalClose: "Закрити",
      topupTab: "Top-up",
      marketplaceTab: "Marketplace (demo)",
      topupService: "Гра/сервіс",
      topupRegion: "Регіон",
      topupAmount: "Сума поповнення",
      topupCustomAmount: "Або введіть суму",
      topupCheckout: "Перейти до оплати",
      topupTest: "Stripe Test / Demo",
      topupNote: "Для продакшену потрібен бекенд (Vercel/Netlify/Firebase) з endpoint для Stripe session.",
      marketFilters: "Пошук / фільтр лотів",
      marketSearchPlaceholder: "Пошук скіна або акаунта",
      marketType: "Тип",
      marketBadge: "ДЕМО",
      marketDisclaimer: "Демонстраційні лоти. Для реальних угод потрібен комплаєнс та дозволені механіки.",
      marketEmpty: "Немає лотів за цим запитом.",
      checkoutDemoTitle: "Демо-оплата",
      checkoutDemoCopy: "Stripe Test або фейковий чек. Сесія створюється на серверлес /api/create-checkout-session.",
      checkoutDone: "Оплата успішна у демо-режимі.",
      checkoutBack: "Повернутися",
      aboutWhat: "Що це?",
      aboutForWhom: "Для кого",
      aboutForWhomItems: [
        "Геймери та стрімери",
        "Арбітраж трафіку",
        "Студії / видавці",
        "Магазини / партнери"
      ],
      aboutValue: "Цінність",
      aboutValue1: "Порівняння цін/знижок між платформами",
      aboutValue2: "Тренди та аналітика «коли купувати»",
      aboutValue3: "Watchlist / алерти",
      aboutValue4: "API для B2B партнерів",
      aboutDiffTitle: "Чому не SteamDB?",
      aboutDiff1: "Multi-platform",
      aboutDiff2: "Рейтинг best deal",
      aboutDiff3: "Плановані алерти",
      aboutDiff4: "B2B API",
      aboutInvestorBlock: "Investor mode (value prop, монетизація, ризики)",
      aboutMissionTitle: "Місія",
      aboutMissionBody: "Єдина точка правди про ціни та тренди ігор, що дає бізнес-інсайт за 30 секунд.",
      aboutValuePropTitle: "Value prop",
      aboutValuePropBody: "Єдина панель для мульти-платформених цін, трендів, watchlist і «best deal» з пріоритетом B2B.",
      aboutMonetization: "Монетизація",
      aboutMonet1: "Freemium (базово безкоштовно)",
      aboutMonet2: "Pro підписка (аналітика, історія, алерти)",
      aboutMonet3: "B2B API (магазини/медіа/студії)",
      aboutMonet4: "Партнерки / affiliates",
      aboutRoadmap: "Roadmap",
      aboutRoadmapHint: "Можна швидко редагувати дати у конфігу.",
      aboutRoadmapMvp: "MVP Demo (ціни, каталог, compare)",
      aboutRoadmapB1: "Beta v1 (ціни+історія+watchlist)",
      aboutRoadmapB2: "Beta v2 (multi-store інтеграції + алерти)",
      aboutRoadmapLaunch: "Public launch",
      aboutRoadmapApi: "B2B API + партнерки",
      aboutRoadmapMobile: "Mobile app",
      aboutRisksTitle: "Ризики / мітігації",
      riskData: "Дані / API: тільки офіційні інтеграції, кеш і валідація.",
      riskLegal: "Легальність: без «сірих» ключів, партнерські ToS, комплаєнс.",
      riskMonet: "Монетизація: freemium → Pro → B2B, ранній affiliate.",
      riskGrowth: "Зростання: ставка на watchlist/alerts, інтеграції зі стрімерами.",
      aboutOwner: "Власник проєкту",
      aboutOwnerMeta: "Founder / product vision / go-to-market",
      aboutCta: "Contact / Partner / Investor",
      aboutCtaPitch: "Open Investor deck",
      aboutCtaTitle: "Call to action",
      aboutCtaCopy: "Хочете партнерство, інвестиції чи інтеграцію API? Напишіть.",
      aboutFaqTitle: "FAQ",
      aboutFaqHint: "Дані, легальність, оновлення.",
      faqQ1: "Як збираємо дані?",
      faqA1: "Офіційні API + парсинг сторінок із кешем; демо працює статично.",
      faqQ2: "Це легально?",
      faqA2: "Демо не продає товари. Для продакшену — тільки офіційні інтеграції та партнерські угоди.",
      faqQ3: "Точність 100%?",
      faqA3: "Цілі — свіжі ціни та алерти. Дані кешуються, валідуються, є стор-відхилення.",
      faqQ4: "Як часто оновлюємо?",
      faqA4: "У демо — статично. У продакшену — щогодини для цін, миттєво для алертів.",
      faqQ5: "Звідки ціни?",
      faqA5: "Steam, PlayStation Store, Xbox, Switch, офіційні магазини ключів. Без «сірих» рітейлерів.",
      faqQ6: "Що з API?",
      faqA6: "REST + вебхуки для алертів. Доступ до price history, best-deal, watchlists (B2B).",
      contactName: "Імʼя / Name",
      contactType: "Тип запиту",
      contactTypePartner: "Партнерство",
      contactTypeInvestor: "Інвестор",
      contactTypeApi: "API інтеграція",
      contactMsg: "Повідомлення",
      contactSend: "Надіслати (локально)",
      contactSaved: "Чернетку збережено у браузері.",
      footerDisclaimer: "Стабільні обкладинки SteamStatic. Демо-версія без сторонніх залежностей.",
      seoKeywords: "ігри, аналітика, marketplace, топап, demo",
      successTitle: "Оплата успішна (demo)",
      successBody: "Stripe Test Mode або фейкова сесія. У продакшені замініть endpoint.",
      cancelTitle: "Оплату скасовано",
      cancelBody: "Спробуйте ще раз або змініть спосіб оплати.",
      badgeTop: "Топ",
      quickCompare: "Швидке порівняння",
      entryLabel: "К-сть на сторінку",
      mobileHint: "Таблиця скролиться по горизонталі",
      investorMetrics: "Демо-метрики",
      investorMau: "MAU (demo)",
      investorArpu: "ARPU (demo)",
      investorConv: "Конверсія в checkout (demo)"
    },
    en: {
      metaTitle: "GameForest — Game catalog & marketplace",
      metaDescription: "GameForest demo board: analytics, top-up marketplace, demo listings for investor preview.",
      navCatalog: "Catalog",
      navMarket: "Marketplace",
      navAbout: "About",
      navSignin: "Sign in",
      any: "All",
      heroCatalogTitle: "Game catalog & analytics",
      heroCatalogSub: "SteamDB-ish board: filters, sorting, compare, demo auth.",
      heroMarketTitle: "Marketplace / Top-up",
      heroMarketSub: "Official balances and demo listings without account transfer.",
      heroAboutTitle: "About GameForest",
      heroAboutSub: "What we're building, for whom, monetization and plans.",
      aboutHero: "Mission & value",
      aboutTagInvestor: "Investor Mode ready",
      aboutTagStatic: "Static demo build",
      aboutTagMulti: "Multi-platform data",
      aboutInvestorToggle: "Investor mode",
      kpiGames: "games tracked",
      kpiCompare: "table + compare",
      kpiLanguages: "live toggle",
      searchPlaceholder: "Search game...",
      filtersTitle: "Filters",
      filterPlatform: "Platform",
      filterGenre: "Genre",
      filterModel: "Model",
      filterMaxPrice: "Max price ($)",
      filterTop: "Only top picks",
      filterApply: "Apply",
      filterReset: "Reset",
      tableTitle: "Table",
      tableHint: "Click a name to open details. Button adds to Compare (up to 4).",
      thName: "Name",
      thOff: "% Off",
      thPrice: "Price",
      thRating: "Rating",
      thPlatforms: "Platforms",
      pagerEntry: "Entries",
      compareBtn: "Compare",
      compareToggle: "In Compare",
      viewDetails: "Game details",
      detailBack: "Back to catalog",
      detailShare: "Share",
      detailAddCompare: "Add to Compare",
      detailShareHint: "Static-friendly: works on GitHub Pages.",
      detailTabOverview: "Overview",
      detailTabPrice: "Price history",
      detailTabPlatforms: "Platforms",
      detailTabNotes: "Notes",
      detailSummary: "Summary",
      detailMetrics: "Health",
      detailPriceHeadline: "Price history",
      detailMin: "Min",
      detailMax: "Max",
      detailAvg: "Avg",
      detailAllTime: "All time",
      detailNoteBuy: "Discount is deep — good moment to buy.",
      detailNoteStable: "Price is stable — low risk to buy now.",
      detailNoteWait: "Better wait for seasonal sale (Black Friday / Winter).",
      detailCopied: "Link copied.",
      detailWatch: "Watchlist / alerts ready",
      pitchBtn: "Pitch / Demo",
      emptyData: "No data. Ensure data.js is loaded.",
      compareHint: "Pick at least 2 games by clicking rows.",
      comparePicked: "Selected",
      compareClear: "Clear selection",
      priceNow: "Price now",
      discount: "% Off",
      rating: "Rating",
      demand: "Demand",
      stability: "Price stability",
      health: "Community",
      platforms: "Platforms",
      model: "Model",
      genre: "Genre",
      login: "Login",
      register: "Register",
      logout: "Logout",
      email: "Email",
      password: "Password",
      password2: "Repeat password",
      createAccount: "Create account",
      haveAccount: "I already have an account",
      signIn: "Sign in",
      noAccount: "Create account",
      badEmail: "Invalid email.",
      passShort: "Password must be at least 6 characters.",
      passMismatch: "Passwords do not match.",
      emailExists: "This email is already registered.",
      wrongCreds: "Wrong email or password.",
      authDisclaimer: "Demo only: passwords are stored locally. Use Supabase/Firebase for production.",
      pitchTitle: "Pitch / Demo",
      pitchProblem: "Game data is scattered across stores and platforms — hard to compare and show business value quickly.",
      pitchSolution: "Single dashboard: table, filters, best deal, compare — 30s to insight.",
      pitchMonetization: "B2B subscription, API, partnerships, affiliate.",
      pitchOwner: "Owner: Malbaro (founder / product vision).",
      pitchInvestors: "Investor mode: MAU/ARPU (demo), backlog Stripe Checkout, Supabase auth, demo marketplace.",
      modalClose: "Close",
      topupTab: "Top-up",
      marketplaceTab: "Marketplace (demo)",
      topupService: "Game/service",
      topupRegion: "Region",
      topupAmount: "Top-up amount",
      topupCustomAmount: "Or enter amount",
      topupCheckout: "Checkout",
      topupTest: "Stripe Test / Demo",
      topupNote: "Production requires backend (Vercel/Netlify/Firebase) endpoint for Stripe session.",
      marketFilters: "Search / filter listings",
      marketSearchPlaceholder: "Search skin or account",
      marketType: "Type",
      marketBadge: "DEMO",
      marketDisclaimer: "Demo listings only. Real trades need compliance and approved mechanics.",
      marketEmpty: "No listings for this query.",
      checkoutDemoTitle: "Demo checkout",
      checkoutDemoCopy: "Stripe Test or fake receipt. Session is created on a serverless /api/create-checkout-session.",
      checkoutDone: "Payment completed in demo mode.",
      checkoutBack: "Back",
      aboutWhat: "What is it?",
      aboutForWhom: "Who is it for",
      aboutForWhomItems: [
        "Gamers & streamers",
        "Traffic arbitrage",
        "Studios / publishers",
        "Stores / partners"
      ],
      aboutValue: "Value",
      aboutValue1: "Price/discount comparison across platforms",
      aboutValue2: "Trends + “when to buy” analytics",
      aboutValue3: "Watchlist / alerts",
      aboutValue4: "API for B2B partners",
      aboutDiffTitle: "Why not SteamDB?",
      aboutDiff1: "Multi-platform",
      aboutDiff2: "Best deal scoring",
      aboutDiff3: "Planned alerts",
      aboutDiff4: "B2B API",
      aboutInvestorBlock: "Investor mode (value prop, monetization, risks)",
      aboutMissionTitle: "Mission",
      aboutMissionBody: "Single source of truth for game prices & trends that gives insight in 30 seconds.",
      aboutValuePropTitle: "Value prop",
      aboutValuePropBody: "One dashboard for multi-platform prices, trends, watchlist, and best deal with B2B priority.",
      aboutMonetization: "Monetization",
      aboutMonet1: "Freemium (baseline free)",
      aboutMonet2: "Pro subscription (analytics, history, alerts)",
      aboutMonet3: "B2B API (stores/media/studios)",
      aboutMonet4: "Affiliates / partnerships",
      aboutRoadmap: "Roadmap",
      aboutRoadmapHint: "Dates can be edited quickly in config.",
      aboutRoadmapMvp: "MVP Demo (prices, catalog, compare)",
      aboutRoadmapB1: "Beta v1 (prices + history + watchlist)",
      aboutRoadmapB2: "Beta v2 (multi-store integrations + alerts)",
      aboutRoadmapLaunch: "Public launch",
      aboutRoadmapApi: "B2B API + affiliates",
      aboutRoadmapMobile: "Mobile app",
      aboutRisksTitle: "Risks / mitigations",
      riskData: "Data / API: official integrations, cache and validation only.",
      riskLegal: "Legality: no gray keys, partner ToS, compliance.",
      riskMonet: "Monetization: freemium → Pro → B2B, early affiliate.",
      riskGrowth: "Growth: lean on watchlist/alerts and streamer integrations.",
      aboutOwner: "Project owner",
      aboutOwnerMeta: "Founder / product vision / go-to-market",
      aboutCta: "Contact / Partner / Investor",
      aboutCtaPitch: "Open Investor deck",
      aboutCtaTitle: "Call to action",
      aboutCtaCopy: "Want partnership, investment or API integration? Reach out.",
      aboutFaqTitle: "FAQ",
      aboutFaqHint: "Data, legality, freshness.",
      faqQ1: "How do you collect data?",
      faqA1: "Official APIs + page scraping with cache; demo works statically.",
      faqQ2: "Is this legal?",
      faqA2: "Demo doesn’t sell goods. Production uses only official integrations and partner agreements.",
      faqQ3: "Accuracy 100%?",
      faqA3: "Goal — fresh prices and alerts. Data is cached/validated; store variance exists.",
      faqQ4: "How often refreshed?",
      faqA4: "Demo — static. Production — hourly for prices, instant for alerts.",
      faqQ5: "Where do prices come from?",
      faqA5: "Steam, PlayStation Store, Xbox, Switch, official key stores. No gray retailers.",
      faqQ6: "What about API?",
      faqA6: "REST + webhooks for alerts. Access to price history, best deal, watchlists (B2B).",
      contactName: "Імʼя / Name",
      contactType: "Request type",
      contactTypePartner: "Partnership",
      contactTypeInvestor: "Investor",
      contactTypeApi: "API integration",
      contactMsg: "Message",
      contactSend: "Send (local)",
      contactSaved: "Draft stored in browser.",
      footerDisclaimer: "Stable SteamStatic covers. Demo build without fragile dependencies.",
      seoKeywords: "games, analytics, marketplace, top-up, demo",
      successTitle: "Payment successful (demo)",
      successBody: "Stripe Test Mode or fake session. Replace endpoint in production.",
      cancelTitle: "Payment canceled",
      cancelBody: "Try again or switch payment option.",
      badgeTop: "Top",
      quickCompare: "Quick compare",
      entryLabel: "Rows per page",
      mobileHint: "Table is horizontally scrollable",
      investorMetrics: "Investor metrics",
      investorMau: "MAU (demo)",
      investorArpu: "ARPU (demo)",
      investorConv: "Checkout conversion (demo)"
    }
  };

  const lang = supported.includes(saved) ? saved : fallback;

  const api = {
    lang,
    t(key){
      return (dict[this.lang] && key in dict[this.lang]) ? dict[this.lang][key] : key;
    },
    setLang(next){
      this.lang = supported.includes(next) ? next : fallback;
      localStorage.setItem(STORAGE_KEY, this.lang);
      document.documentElement.lang = this.lang;
      this.apply(document);
    },
    apply(root){
      if (!root) return;
      root.querySelectorAll("[data-i18n]").forEach(el => {
        const key = el.getAttribute("data-i18n");
        const val = this.t(key);
        if (Array.isArray(val)) {
          el.textContent = val.join(" · ");
        } else {
          el.textContent = val;
        }
      });
      root.querySelectorAll("[data-i18n-placeholder]").forEach(el => {
        const key = el.getAttribute("data-i18n-placeholder");
        const val = this.t(key);
        el.setAttribute("placeholder", Array.isArray(val) ? val.join(" ") : val);
      });
    }
  };

  window.GF_I18N = api;
  document.title = api.t("metaTitle");
  const metaDesc = document.querySelector('meta[name="description"]');
  if (metaDesc) metaDesc.setAttribute("content", api.t("metaDescription"));
  const metaKeywords = document.querySelector('meta[name="keywords"]');
  if (metaKeywords) metaKeywords.setAttribute("content", api.t("seoKeywords"));
  document.documentElement.lang = api.lang;
})();
