<!doctype html>
<html lang="uk" data-theme="dark">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GameForest — Marketplace</title>
  <meta name="description" content="Marketplace and balance top-ups in a production-ready layout." />
  <meta name="keywords" content="marketplace, top-up" />
  <link rel="icon" type="image/svg+xml" href="./assets/gameforest-logo.svg">
  <link rel="stylesheet" href="./styles.css?v=official" />
</head>
<body data-page="market">
  <header class="topbar">
    <div class="topbar__left">
      <button class="iconbtn iconbtn--bare" id="btnMenu" title="Menu">☰</button>
      <a class="brand" href="index.html">
        <div class="brand__logo"><img src="./assets/gameforest-logo.svg" alt="GameForest logo"></div>
        <div class="brand__name">GameForest</div>
      </a>
      <nav class="topnav">
        <a class="topnav__btn" data-page="catalog" href="index.html" data-i18n="navCatalog">Каталог</a>
        <a class="topnav__btn" data-page="market" href="market.html" data-i18n="navMarket">Маркетплейс</a>
        <a class="topnav__btn" data-page="about" href="about.html" data-i18n="navAbout">Про проєкт</a>
        <a class="topnav__btn" data-page="account" href="account.html" data-i18n="navAccount">Мій акаунт</a>
      </nav>
    </div>
    <div class="topbar__center"></div>
    <div class="topbar__right">
      <button class="chip chip--ghost" id="themeToggle" title="Dark / Light">Dark</button>
      <button class="chip chip--ghost" id="langToggle" title="UA / EN">UA</button>
      <div class="userpill" id="userToggle" role="button" tabindex="0">
        <div class="avatar" aria-hidden="true" id="userAvatar">
          <img id="userAvatarImg" alt="" hidden>
          <svg viewBox="0 0 40 40" role="presentation" focusable="false">
            <circle cx="20" cy="14" r="9" class="avatar__face"></circle>
            <rect x="8" y="24" width="24" height="10" rx="5" class="avatar__body"></rect>
          </svg>
        </div>
        <div class="userpill__meta">
          <div class="userpill__email" id="userMenuEmail">guest@gameforest.app</div>
          <div class="userpill__hint" data-i18n="navAccount">Мій акаунт</div>
        </div>
        <span class="chevron">▾</span>
      </div>
      <div class="auth">
        <span class="auth__user" id="userBadge" hidden></span>
        <button class="btn btn--ghost" id="btnLogin" data-i18n="login">Увійти</button>
        <button class="btn btn--primary" id="btnRegister" data-i18n="register">Реєстрація</button>
        <button class="btn btn--ghost" id="btnLogout" hidden data-i18n="logout">Вийти</button>
      </div>
    </div>
  </header>
  <div class="dropdown hidden" id="userDropdown">
    <a class="dropdown__item" href="account.html" data-i18n="navAccount">Мій акаунт</a>
    <button class="dropdown__item" type="button" data-go="wishlist" data-i18n="wishlist">Wishlist</button>
    <button class="dropdown__item" type="button" data-go="cart" data-i18n="cart">Кошик</button>
    <button class="dropdown__item" type="button" data-open="pitch" data-i18n="pitchBtn">Pitch</button>
    <button class="dropdown__item" type="button" id="dropdownLogout" data-i18n="logout">Вийти</button>
  </div>
  <div class="drawer" id="navDrawer">
    <div class="drawer__backdrop" data-close="drawer"></div>
    <aside class="drawer__panel">
      <div class="drawer__head">
        <div class="drawer__title" data-i18n="drawerTitle">Швидке меню</div>
        <button class="iconbtn iconbtn--bare" data-close="drawer">✕</button>
      </div>
      <div class="drawer__links">
        <a href="index.html" data-page="catalog" data-i18n="navCatalog">Каталог</a>
        <a href="market.html" data-page="market" data-i18n="navMarket">Маркетплейс</a>
        <a href="about.html" data-page="about" data-i18n="navAbout">Про проєкт</a>
        <a href="account.html" data-page="account" data-i18n="navAccount">Мій акаунт</a>
      </div>
      <div class="drawer__actions">
        <button class="btn btn--ghost w100" data-drawer="wishlist" data-i18n="wishlist">Wishlist</button>
        <button class="btn btn--ghost w100" data-drawer="compare" data-i18n="compareBtn">Compare</button>
        <button class="btn btn--ghost w100" data-open="pitch" data-i18n="pitchBtn">Pitch</button>
      </div>
    </aside>
  </div>

  <main class="layout page-grid">
    <section class="page-header">
      <div>
        <div class="hero__eyebrow">Marketplace desk</div>
        <h1 class="page-header__title" data-i18n="heroMarketTitle">Маркетплейс / Top-up</h1>
        <div class="page-header__meta" data-i18n="heroMarketSub">Реальні категорії: Roblox валюта, CS2 скіни та кейси. Пошук, фільтри, кошик.</div>
      </div>
      <div class="page-header__actions">
        <span class="pill">Robux</span>
        <span class="pill">CS2 Skins</span>
        <span class="pill">CS2 Cases</span>
      </div>
    </section>

    <section class="market-hero">
      <div class="panel">
        <div class="panel__head">
          <div>
            <div class="panel__title">Вертикалі</div>
            <div class="panel__muted">Robux пакети, скіни CS2, кейси — готово до checkout.</div>
          </div>
        </div>
        <div class="panel__body cardgrid">
          <div class="card card--accent">
            <div class="card__head">
              <div class="card__title">Roblox Robux</div>
              <span class="pill">Currency</span>
            </div>
            <div class="card__desc">Пакети 800–10 000 R$ з фіксованими курсами та миттєвим підтвердженням.</div>
          </div>
          <div class="card">
            <div class="card__head">
              <div class="card__title">CS2 Skins</div>
              <span class="pill">Skins</span>
            </div>
            <div class="card__desc">AWP Dragon Lore, Prime Karambit, перевірені продавці і метрики попиту.</div>
          </div>
          <div class="card">
            <div class="card__head">
              <div class="card__title">CS2 Cases</div>
              <span class="pill">Cases</span>
            </div>
            <div class="card__desc">Horizon/Mirage колекції, ціна за кейс та бандли з CTA «Купити».</div>
          </div>
        </div>
      </div>
      <div class="panel">
        <div class="panel__head">
          <div>
            <div class="panel__title">Контекст користувача</div>
            <div class="panel__muted">Email, wishlist, кошик — синхронізовано з каталогом.</div>
          </div>
        </div>
        <div class="panel__body market-meta">
          <div class="statcard">
            <div class="statcard__label">Account email</div>
            <div class="statcard__value" id="marketUserEmail">guest@gameforest.app</div>
            <div class="statcard__hint">Supabase session</div>
          </div>
          <div class="statcard">
            <div class="statcard__label" data-i18n="wishlist">Wishlist</div>
            <div class="statcard__value" id="marketWishCount">0</div>
            <div class="statcard__hint">з каталогу</div>
          </div>
          <div class="statcard">
            <div class="statcard__label" data-i18n="cart">Кошик</div>
            <div class="statcard__value" id="marketCartCount">0</div>
            <div class="statcard__hint">готово до checkout</div>
          </div>
        </div>
      </div>
    </section>

    <section class="panel">
      <div class="panel__head">
        <div>
          <div class="panel__title" data-i18n="topupTab">Top-up</div>
          <div class="panel__muted" data-i18n="topupNote">Симуляція оплати: оберіть сервіс, регіон та суму.</div>
        </div>
      </div>
      <div class="panel__body market-grid">
        <div class="formblock">
          <div class="field">
            <label class="label" data-i18n="topupService">Гра/сервіс</label>
            <select id="serviceSelect" class="select"></select>
          </div>
          <div class="field">
            <label class="label" data-i18n="topupRegion">Регіон</label>
            <select id="regionSelect" class="select"></select>
          </div>
          <div class="field">
            <label class="label" data-i18n="topupAmount">Сума поповнення</label>
            <select id="amountSelect" class="select"></select>
          </div>
          <div class="field">
            <label class="label" data-i18n="topupCustomAmount">Або введіть суму</label>
            <input id="customAmount" class="input" type="number" min="0" step="1" placeholder="25" />
          </div>
          <div class="field">
            <label class="label">Checkout</label>
            <div class="radiolist">
              <label><input type="radio" name="checkoutMode" value="sandbox" checked> Sandbox</label>
              <label><input type="radio" name="checkoutMode" value="stripe"> Stripe Test</label>
            </div>
          </div>
          <button class="btn btn--primary" id="checkoutBtn" data-i18n="topupCheckout">Перейти до оплати</button>
        </div>
        <div class="summary" id="topupSummary"></div>
      </div>
    </section>

    <section class="panel">
      <div class="panel__head">
        <div>
          <div class="panel__title" data-i18n="marketFilters">Пошук / фільтр лотів</div>
          <div class="panel__muted" id="marketDisclaimer" data-i18n="marketDisclaimer">Лоти для прев'ю.</div>
        </div>
        <div class="market-cart">
          <div>
            <div class="statcard__label">Кошик маркетплейсу</div>
            <div class="statcard__value" id="marketCartValue">0</div>
          </div>
          <button class="btn btn--ghost btn--mini" id="marketCartClear">Очистити</button>
        </div>
      </div>
      <div class="panel__body">
        <div class="market-filters">
          <input id="listingSearch" class="input" type="search" data-i18n-placeholder="marketSearchPlaceholder" placeholder="Пошук" />
          <select id="listingType" class="select">
            <option value="">All</option>
            <option value="Skin">Skin</option>
            <option value="Case">Case</option>
            <option value="Currency">Currency</option>
            <option value="Account">Account</option>
          </select>
          <select id="listingPlatform" class="select">
            <option value="">Platform</option>
            <option value="PC">PC</option>
            <option value="PC/Mobile">PC/Mobile</option>
            <option value="PC/Console">PC/Console</option>
            <option value="Global">Global</option>
          </select>
          <select id="listingSort" class="select">
            <option value="price">Price ↑</option>
            <option value="price_desc">Price ↓</option>
            <option value="title">Title</option>
          </select>
        </div>
        <div id="listingWrap" class="marketlist"></div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="site-footer__wrap">
      <div class="footer__brand">
        <div class="brand__logo"><img src="./assets/gameforest-logo.svg" alt=""></div>
        <div>
          <div class="footer__title">© GameForest. Усі права захищені.</div>
          <div class="footer__disclaimer" data-i18n="footerDisclaimer">Стабільний CDN, кешовані дані та продакшн-ready фронтенд без зайвих залежностей.</div>
        </div>
      </div>
      <div class="footer__payments">
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9">VISA</text></svg>Visa</span>
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9">MC</text></svg>MasterCard</span>
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9"></text></svg>Apple Pay</span>
        <span class="payicon"><svg viewBox="0 0 32 20" aria-hidden="true"><rect x="1" y="2" width="30" height="16" rx="4" fill="none" stroke="currentColor"/><text x="16" y="14" text-anchor="middle" fill="currentColor" font-weight="800" font-size="9">G</text></svg>Google Pay</span>
      </div>
      <div class="footer__links">
        <a href="#" aria-label="Terms">Terms</a>
        <a href="#" aria-label="Privacy">Privacy</a>
        <a href="#" aria-label="Support">Support</a>
      </div>
      <div class="footer__legal">
        Відображаємо аватар та email, приймаємо валюти, показуємо реальні категорії лотів.
      </div>
    </div>
  </footer>

  <div class="modal hidden" id="authModal">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__card">
      <div class="modal__head">
        <div class="modal__title" id="authTitle">Auth</div>
        <button class="iconbtn" data-close="1">✕</button>
      </div>
      <div class="modal__body" id="authBody"></div>
    </div>
  </div>

  <div class="modal hidden" id="pitchModal">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__card modal__card--wide">
      <div class="modal__head">
        <div class="modal__title" id="pitchTitle">Pitch deck</div>
        <button class="iconbtn" data-close="1">✕</button>
      </div>
      <div class="modal__body" id="pitchBody"></div>
    </div>
  </div>

  <div class="modal hidden" id="checkoutModal">
    <div class="modal__backdrop" data-close="1"></div>
    <div class="modal__card modal__card--wide">
      <div class="modal__head">
        <div class="modal__title" data-i18n="checkoutDemoTitle">Перевірка оплати</div>
        <button class="iconbtn" data-close="1">✕</button>
      </div>
      <div class="modal__body" id="checkoutBody"></div>
    </div>
  </div>

  <script src="./i18n.js"></script>
  <script src="./supabase-config.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.44.4/dist/umd/supabase.min.js"></script>
  <script src="./auth.js"></script>
  <script src="./shell.js"></script>
  <script src="./market-data.js"></script>
  <script src="./market.js"></script>
</body>
</html>
